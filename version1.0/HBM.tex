%% HBM
%%

\subsection{Calibration Data}

For our calibration of \rhostar-$F_8$, we used a sample of Kepler stars with
both asteroseismic and flicker measurements available. \citet{chaplin:2014}
report asteroseismic \rhostar\ estimates (and the associated uncertainties) for
518 Kepler stars. The authors report three different sets of results, depending
on the choice of \Teff\ and \FeH, and in this work we elected to use values
reported in their Table 6 over Table 5, and Table 5 over Table 4. We
additionally used the 71 additional planet hosting stars with asteroseismology
reported in \citet{huber:2013} but not reported in \citet{chaplin:2014}. Values
for flicker and range were taken from \citet{kipping:2014}, based upon the
methods described in \citet{bastien:2013}. Following \citet{kipping:2014} and
for reasons described there-in, we only include targets in our calibration for
which:

\begin{itemize}
\item[{\tiny$\blacksquare$}] Range (defined in \citealt{bastien:2013})
$<1$\,ppt
\item[{\tiny$\blacksquare$}] $4500<T_{\mathrm{eff}}<6500$\,K
\item[{\tiny$\blacksquare$}] $K_P<14$
\item[{\tiny$\blacksquare$}] $1.2 < \log_{10}$($F_8$\,[ppm])$< 2.2$
\end{itemize}

We use the same sample for our calibration of \logg, except that we exclude the
\citet{huber:2013} data, since these authors do not provide estimates of
\logg\footnote{Whilst we could compute \logg\ ourselves from the reported
masses and radii, this could only be done under the incorrect assumption of
zero covariance between $M_{\star}$ and $R_{\star}$.}

\subsection{Hierarchical Bayesian Model}

We model the stochastic relationship between flicker, log($g$) and stellar
density, accounting for the fact that there exists some intrinsic scatter in
the dependent variable, and including the heteroskedastic uncertainties on both
the dependent and independent variables.
There are two excellent reasons for modelling the relation stochastically;
firstly, if the intrinsic scatter is ignored and the relation between
variables is assumed to be deterministic, those data points with smaller
measurement uncertainties may have an unrepresentative greater weighting
during the fitting process.
Secondly, we are interested in producing probability distributions over stellar
densities and surface gravities, as opposed to point estimates, and propagating
these probability distributions through to subsequent analyses.
Several recent studies have required posterior Probability Distribution
Function (PDF) samples, in order to conduct their (hierarchical)
analyses \citep[e.g.][]{rogers:2014, foreman-Mackey:2014, angus:2015}.
Including observational uncertainties on the independent variable within our
analysis is also important, because ordinary least squares regression methods
performed on data with two-dimensional uncertainties will result in a slope
that is biased towards zero
(e.g., Fuller 1987; Akritas \& Bershady 1996; Fox 1997).
or a demonstration of the effects of neglecting intrinsic scatter and
two-dimensional uncertainties, see Kelly (2007).

The two models describing the relationship between flicker, logg and stellar
density can be written as
\begin{equation}
	\rho_* \sim \mathcal{N}(\mu = \alpha + \beta F_8, \sigma^2 = \
	\sigma^2 + \gamma F_8),
\end{equation}
\label{eq:rho}
and
\begin{equation}
	\log_{10}(g) \sim \mathcal{N}(\mu = \delta + \epsilon F_8, \sigma^2 = \
	\sigma^2 + \zeta F_8)
\end{equation}
\label{eq:logg}
where $F_8$ is flicker and $\rho_*$ is stellar density.
The free parameters of the two models are $\alpha$, $\beta$, $\sigma_G$,
$\gamma$, $\delta$, $\epsilon$ and $\zeta$.
The two relationships can be described as Gaussian distributions with means
given by the equation of a straight line, and standard deviations given by
observational uncertainties, plus some dispersion which is a function of the
dependent variable.

In order to account for the two-dimensional observational uncertainties in
this data set, we marginalize over the latent, `true' values of flicker,
stellar density and $\log(g)$
\citep[see, e.g.][]{hogg:2010, foreman-mackey:2014, rogers:2015, angus:2015}.
The observed values of the variables, flicker, stellar density and $\log(g)$
can be thought of as a single `draw' from an underlying (assumed Gaussian)
probability distribution, with mean equal to the `true' value and standard
deviation equal to the quoted uncertainty.
We compute the likelihood of the data given the model, marginalized over the
`true' values of the variables, using importance sampling.
We sample from the PDF of the `truth', given the observed value and compute
the likelihood of each of those samples.
This PDF is actually a {\it posterior} PDF, produced by the astronomers who
provide the catalog.
For example, the $log(g)$ values used here are point estimates of the
posterior PDFs of $log(g)$, produced by \citet{chaplin:2014} using
{\it Kepler} light curves and stellar models.
We would use the posterior samples generated in previous model fitting process
if they were available, however generating new samples is an acceptable
approximation provided the posteriors are Gaussian (or log-Normal) and the
priors used by the previous fitters were uninformative.
Such an approximation {\it will not be necessary} for those studies using
the stellar densities or $\log(g)$s calculated using newly-calibrated relations
presented here, as long as the posterior PDF samples are published!
After producing new posterior PDF samples we then add up the individual log-likelihoods of each sample to compute the total marginalized likelihood for a star.
The marginalized likelihood of the whole dataset is then computed as the sum
of the log-likelihoods of each star.

%%% rhostar plot
\begin{figure}
\begin{center}
\includegraphics[width=8.4cm,angle=0,clip=true]{../figs/rho_vs_flicker.pdf}
\caption{
TBD
}
\label{fig:rhostar}
\end{center}
\end{figure}

%%% logg plot
\begin{figure}
\begin{center}
\includegraphics[width=8.4cm,angle=0,clip=true]{../figs/logg_vs_flicker.pdf}
\caption{
TBD
}
\label{fig:logg}
\end{center}
\end{figure}
